---
title: 'PyTorch Performance Tuning Guide'
date: '2020-09-01'
tag: PyTorch, 工程, 深度学习 
abstract: 个人学习笔记记录
---

## 内置 api

- DataLoader

    1. use `num_workers>0`, eg `num_workers=4/8`, and `pin_memory=True`

- 加速 CNN

    1. `torch.backends.cudnn.benchmark=True`

- BatchNorm

    1. 如果使用 cnn 后接了一层 BatchNorm, 最好 cnn 中 `bias=False`

- 混合精度加速

- 单机多卡，多机多卡

    1. use `DistributedDataParalle` instead of `DataParallel`

- pytorch jit

    ```python
    @torch.jit.script
    def gelu(x):
        pass
    ```

## Trick

    1. large-batch ofen better, add lr-warmup, lr-decay, weight-decay

    1. also could switch to optimizer designed for large-batch traing

        1. LARS

        1. LAMB 
